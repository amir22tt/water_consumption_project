<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Water Consumption Predictor</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
      body { background: linear-gradient(135deg, #f91e8d 0%, #0284c7 50%, #f91e8d 100%); min-height: 100vh; opacity: 0.95; filter: brightness(0.9); }
      .card { border-radius: 1.5rem; box-shadow: 0 20px 40px rgba(236, 72, 153, 0.25); border: 2px solid rgba(236, 72, 153, 0.3); background: rgba(255, 255, 255, 0.98); }
      .hero { padding: 2rem; }
      h2 { color: #ffffff; font-weight: 700; text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3); font-size: 2.5rem; }
      .footer { font-size: .9rem; color: #475569; }
      .result { font-weight: 700; font-size: 1.25rem; color: #db2777; }
      .small-muted { font-size: .85rem; color: #334155; }
      p { color: #1e293b; font-weight: 500; font-size: 1.1rem; }
      .form-label { font-weight: 600; color: #1e293b; }
      .upload-area { border: 2px dashed #db2777; padding: 1rem; border-radius: .75rem; background: rgba(219, 39, 119, 0.08); }
      .form-control, .form-select { border: 2px solid #0284c7; border-radius: 0.5rem; transition: all 0.3s ease; background: rgba(255, 255, 255, 0.98); }
      .form-control:focus, .form-select:focus { border-color: #db2777; box-shadow: 0 0 0 3px rgba(219, 39, 119, 0.15); }
      .btn-primary { background: linear-gradient(135deg, #db2777 0%, #0369a1 100%); border: none; border-radius: 0.5rem; font-weight: 600; color: white; }
      .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(219, 39, 119, 0.4); }
      .btn-success { background: linear-gradient(135deg, #059669 0%, #0284c7 100%); border: none; border-radius: 0.5rem; font-weight: 600; color: white; }
      .btn-success:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(5, 150, 105, 0.4); }
      .btn-outline-secondary { border: 2px solid #0369a1; border-radius: 0.5rem; color: #0369a1; font-weight: 600; }
      .btn-outline-secondary:hover { background: #0369a1; color: white; }
      .alert-success { background: rgba(5, 150, 105, 0.15); border: 2px solid rgba(5, 150, 105, 0.4); border-radius: 0.75rem; }
      .alert-info { background: rgba(3, 105, 161, 0.15); border: 2px solid rgba(3, 105, 161, 0.4); border-radius: 0.75rem; }
    </style>
  </head>
  <body>
    <div class="container py-4">
      <div class="row justify-content-center">
        <div class="col-lg-10">
          <h2 class="mb-2">Water Consumption Predictor</h2>
          <p class="small-muted mb-4">Enter the day's details and get an estimate of water consumed (liters). Uses your trained model if available; otherwise a safe fallback estimation is used.</p>
          <div class="card p-3">
            <div class="row g-0 align-items-center">
              <div class="col-md-5 hero">
                {% if last_prediction is defined and last_prediction is not none %}
                <div class="alert alert-success mt-3">
                  <div class="result">Predicted water consumed: {{ last_prediction }} L</div>
                  <div class="small-muted">Model used: {{ model_used }}</div>
                </div>
                {% endif %}
                {% with messages = get_flashed_messages() %}
                  {% if messages %}
                    {% for msg in messages %}
                      <div class="alert alert-info">{{ msg }}</div>
                    {% endfor %}
                  {% endif %}
                {% endwith %}
              </div>

              <div class="col-md-7 p-3">
                <form method="post" action="/predict" class="row g-3">
                  <div class="col-md-6">
                    <label class="form-label">Date</label>
                    <input class="form-control" type="date" name="date" value="{{ form_data.get('Date', today) }}" required>
                  </div>
                  <div class="col-md-6">
                    <label class="form-label">Person ID</label>
                    <select class="form-select" name="person_id">
                      {% for pid in person_ids %}
                      <option value="{{ pid }}" {% if form_data.get('Person_ID') == pid %}selected{% endif %}>{{ pid }}</option>
                      {% endfor %}
                    </select>
                  </div>

                  <div class="col-md-6">
                    <label class="form-label">Age</label>
                    <input type="number" name="age" class="form-control" value="{{ form_data.get('Age', '21') }}" min="1" max="120" required>
                  </div>

                  <div class="col-md-6">
                    <label class="form-label">Temperature (°C)</label>
                    <input type="number" step="0.1" name="temperature" class="form-control" value="{{ form_data.get('Temperature_C', '30.0') }}" required>
                  </div>

                  <div class="col-md-6">
                    <label class="form-label">Gender</label>
                    <select class="form-select" name="gender">
                      {% for g in genders %}
                      <option value="{{ g }}" {% if form_data.get('Gender') == g %}selected{% endif %}>{{ g }}</option>
                      {% endfor %}
                    </select>
                  </div>

                  <div class="col-md-6">
                    <label class="form-label">City</label>
                    <select class="form-select" name="city">
                      {% for c in cities %}
                      <option value="{{ c }}" {% if form_data.get('City') == c %}selected{% endif %}>{{ c.capitalize() }}</option>
                      {% endfor %}
                    </select>
                  </div>

                  <div class="col-md-12">
                    <label class="form-label">Activity Level</label>
                    <select class="form-select" name="activity_level">
                      {% for a in activity_levels %}
                      <option value="{{ a }}" {% if form_data.get('Activity_Level') == a %}selected{% endif %}>{{ a }}</option>
                      {% endfor %}
                    </select>
                  </div>

                  <div class="col-12 d-flex gap-2">
                    <button class="btn btn-primary" type="submit">Predict</button>
                    <a class="btn btn-outline-secondary" href="/about">About</a>
                  </div>
                </form>

              </div>
            </div>
          </div>

          <div class="text-center mt-3 footer">Built with ❤️ by Amir Zaheer • Place your model at <code>{{ model_path }}</code></div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
